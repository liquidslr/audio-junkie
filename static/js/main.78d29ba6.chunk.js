(this["webpackJsonpvernacular-task"]=this["webpackJsonpvernacular-task"]||[]).push([[0],{17:function(e,t,a){e.exports=a(29)},28:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(8),r=a.n(o),s=a(6),c=(a(28),a(1)),l=a(2),d=a(4),u=a(3),h=a(15),p=a.n(h)()({SET_RECORDING:null,REMOVE_RECORDING:null});function f(e,t,a){for(var n=0;n<a.length;n++)e.setUint8(t+n,a.charCodeAt(n))}function v(e,t){for(var a=new Float64Array(t),n=0,i=0;i<e.length;i++){var o=e[i];a.set(o,n),n+=o.length}return a}function g(e,t){for(var a=e.length+t.length,n=new Float64Array(a),i=0,o=0;o<a;)n[o++]=e[i],n[o++]=t[i],i++;return n}var b=navigator.mediaDevices?function(e,t,a){navigator.mediaDevices.getUserMedia(e).then(t).catch(a)}:navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,m=AudioContext,y=function(){function e(){Object(c.a)(this,e),this.recordingNodes=[]}return Object(l.a)(e,[{key:"startRecording",value:function(){var t=this;return new Promise((function(a,n){b({audio:!0},(function(n){var i=e.audioContext,o=i.createGain(),r=i.createMediaStreamSource(n),s=i.createScriptProcessor(e.bufferSize,2,2);t.encodingCache&&(t.encodingCache=null),s.onaudioprocess=function(e){t.encodingCache&&(t.encodingCache=null);for(var a=0;a<2;a++){var n=e.inputBuffer.getChannelData(a);t.buffers[a].push(new Float32Array(n))}},r.connect(o),o.connect(s),s.connect(i.destination),t.recordingStream=n,t.recordingNodes.push(r,o,s),a(n)}),(function(e){n(e)}))}))}},{key:"stopRecording",value:function(){for(var e in this.recordingStream&&(this.recordingStream.getTracks()[0].stop(),delete this.recordingStream),this.recordingNodes)this.recordingNodes[e].disconnect(),delete this.recordingNodes[e]}},{key:"startPlayback",value:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;return new Promise((function(i,o){var r=new FileReader;r.readAsArrayBuffer(t.audioData),r.onloadend=function(){e.audioContext.decodeAudioData(r.result,(function(o){var r=e.audioContext.createBufferSource();r.buffer=o,r.connect(e.audioContext.destination),r.loop=a,r.start(0),r.onended=n,t.playbackNode=r,i(r)}))}}))}},{key:"stopPlayback",value:function(){this.playbackNode.stop()}},{key:"reset",value:function(){this.playbackNode&&(this.playbackNode.stop(),this.playbackNode.disconnect(0),delete this.playbackNode),this.stopRecording(),this.buffers=[[],[]]}},{key:"bufferLength",get:function(){return this.buffers[0].length*e.bufferSize}},{key:"audioDuration",get:function(){return this.bufferLength/e.audioContext.sampleRate}},{key:"audioData",get:function(){return this.encodingCache||function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=v(e[0],t),o=v(e[1],t),r=g(i,o),s=new ArrayBuffer(44+2*r.length),c=new DataView(s);return f(c,0,"RIFF"),c.setUint32(4,44+2*r.length,!0),f(c,8,"WAVE"),f(c,12,"fmt "),c.setUint32(16,16,!0),c.setUint16(20,1,!0),c.setUint16(22,2,!0),c.setUint32(24,a,!0),c.setUint32(28,4*a,!0),c.setUint16(32,4,!0),c.setUint16(34,16,!0),f(c,36,"data"),c.setUint32(40,2*r.length,!0),r.forEach((function(e,t){c.setInt16(44+2*t,e*(32767*n),!0)})),new Blob([c],{type:"audio/wav"})}(this.buffers,this.bufferLength,e.audioContext.sampleRate)}}]),e}();function w(e,t){var a=window.URL.createObjectURL(e),n=document.createEvent("Event");n.initEvent("click",!0,!0);var i=document.createElement("A");return i.href=a,i.download=t,i.dispatchEvent(n),i.click(),i}y.audioContext=new m,y.bufferSize=2048;a(7);var E=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).waveInterface=new y,e.state={isRecording:!1,isPlaying:!1,audioData:e.props.initialAudio},e.onAudioEnded=function(){e.setState({isPlaying:!1}),e.props.onEnded&&e.props.onEnded()},e.onRemoveClick=function(){var t=e.props,a=t.id,n=t.recorder;e.waveInterface.reset(),e.state.audioData&&e.props.onChange&&e.props.onChange({duration:0,audioData:null}),e.setState({isPlaying:!1,isRecording:!1,audioData:null}),e.props.removeRecording([a,n])},e.onDownloadClick=function(){w(e.state.audioData,e.props.filename)},e.onButtonClick=function(t){e.state.audioData?e.state.isPlaying?(e.stopPlayback(),t.preventDefault()):e.startPlayback():e.state.isRecording?e.stopRecording():e.startRecording()},e}return Object(l.a)(a,[{key:"componentWillReceiveProps",value:function(e){e.initialAudio&&e.initialAudio!==this.props.initialAudio&&this.state.audioData&&e.initialAudio!==this.state.audioData&&(this.waveInterface.reset(),this.setState({audioData:e.initialAudio,isPlaying:!1,isRecording:!1}))}},{key:"componentWillMount",value:function(){this.waveInterface.reset()}},{key:"componentWillUnmount",value:function(){this.waveInterface.reset()}},{key:"startRecording",value:function(){var e=this;this.state.isRecording||this.waveInterface.startRecording().then((function(){e.setState({isRecording:!0}),e.props.onRecordStart&&e.props.onRecordStart()})).catch((function(e){throw e}))}},{key:"stopRecording",value:function(){var e=this.props,t=e.id,a=e.recorder;this.waveInterface.stopRecording(),this.setState({isRecording:!1,audioData:this.waveInterface.audioData}),this.props.setRecording([t,a,this.waveInterface.audioData]),this.props.onChange&&(this.props.onChange({duration:this.waveInterface.audioDuration,audioData:this.waveInterface.audioData}),this.props.setRecording([t,a,this.waveInterface.audioData]))}},{key:"startPlayback",value:function(){var e=this;this.state.isPlaying||this.waveInterface.startPlayback(this.props.loop,this.onAudioEnded).then((function(){e.setState({isPlaying:!0}),e.props.onPlay&&e.props.onPlay()}))}},{key:"stopPlayback",value:function(){this.waveInterface.stopPlayback(),this.setState({isPlaying:!1}),this.props.onAbort&&this.props.onAbort()}},{key:"render",value:function(){return i.a.createElement("div",{className:"AudioRecorder"},i.a.createElement("button",{className:["AudioRecorder-button control-btn",this.state.audioData?"hasAudio":"",this.state.isPlaying?"isPlaying":"",this.state.isRecording?"isRecording":""].join(" "),onClick:this.onButtonClick},this.state.audioData&&!this.state.isPlaying&&this.props.playLabel,this.state.audioData&&this.state.isPlaying&&this.props.playingLabel,!this.state.audioData&&!this.state.isRecording&&this.props.recordLabel,!this.state.audioData&&this.state.isRecording&&this.props.recordingLabel),this.state.audioData&&i.a.createElement("button",{className:"AudioRecorder-remove control-btn",onClick:this.onRemoveClick},this.props.removeLabel),this.state.audioData&&this.props.downloadable&&i.a.createElement("button",{className:"AudioRecorder-download control-btn",onClick:this.onDownloadClick},this.props.downloadLabel))}}]),a}(n.Component),R=Object(s.b)(null,(function(e){return{setRecording:function(t){return e(function(e){return function(t){t({type:p.SET_RECORDING,payload:e})}}(t))},removeRecording:function(t){return e(function(e){return function(t){t({type:p.REMOVE_RECORDING,payload:e})}}(t))}}}))(E);E.defaultProps={loop:!1,downloadable:!0,className:"",style:{},filename:"output.wav",playLabel:"\ud83d\udd0a Play",playingLabel:"\u275a\u275a Playing",recordLabel:"\u25cf Record",recordingLabel:"\u25cf Recording",removeLabel:"\u21ba Re-record",downloadLabel:"\ud83d\udcbe Save"};var k=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={disabled:!1},e.change=function(t){e.state.disabled&&(e.setState({input:""}),e.setState({disabled:!1})),e.setState({input:t.target.value})},e.click=function(){e.state.disabled&&(e.setState({input:""}),e.setState({disabled:!1}))},e.startRecording=function(){e.setState({disabled:!0})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.input,a=e.disabled,n=this.props,o=n.text,r=n.item,s=n.type;return i.a.createElement("div",{className:"conv"},i.a.createElement("div",{className:"margin1 title"},o),i.a.createElement("div",{onClick:this.click},i.a.createElement("textarea",{value:t,disabled:a,onChange:this.change,style:{padding:"1rem"},className:"margin1",placeholder:"Enter input"})),t&&i.a.createElement(R,{onChange:this.startRecording,id:r,recorder:s}))}}]),a}(n.Component),O=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).concatenateBlobs=function(e,t,a){var n=[],i=0;!function o(){if(!e[i])return function(){var e=0;n.forEach((function(t){console.log(t.byteLength,"bytelength"),e+=t.byteLength})),console.log(e,"length");var i=new Uint16Array(e),o=0;n.forEach((function(e){var t=e.byteLength;t%2!=0&&(e=e.slice(0,t-1)),i.set(new Uint16Array(e),o),o+=t}));var r=new Blob([i.buffer],{type:t});a(r)}();var r=new FileReader;r.onload=function(e){n.push(e.target.result),i++,o()},r.readAsArrayBuffer(e[i])}()},e.download=function(t){var a=e.props.recording,n=t.toString(),i=a.recordings[n],o=i.bot,r=i.customer;e.concatenateBlobs([r,o],"audio/wav",(function(e){w(e,"combined-audio")}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.item;t.deleteItem;return i.a.createElement("div",{key:a,className:"snippet"},i.a.createElement("div",{className:"heading"},"Snippet ",a," "),i.a.createElement(k,{item:a,text:"bot",type:"bot"}),i.a.createElement(k,{item:a,text:"customer",type:"customer"}),i.a.createElement("div",{className:"content",extra:!0},i.a.createElement("button",{onClick:function(){return e.download(a)},className:"download btn"},"Download"),i.a.createElement("button",{className:"delete btn",negative:!0,onClick:function(){return e.props.deleteItem(a)}},"Delete")))}}]),a}(n.Component),C=Object(s.b)((function(e){return{recording:e.recordings}}),null)(O),D=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={items:[1]},e.addSnippet=function(){var t=e.state.items;t.push(t[t.length-1]+1||1),e.setState({items:t})},e.delete=function(t){var a=e.state.items,n=a.indexOf(t);n>-1&&a.splice(n,1),e.setState({items:a})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state.items;return i.a.createElement("div",{className:"App"},t.map((function(t){return i.a.createElement(C,{deleteItem:e.delete,item:t})})),i.a.createElement("div",{className:"snippet"},i.a.createElement("div",{className:"center",onClick:this.addSnippet},i.a.createElement("div",null,i.a.createElement("i",{class:"fa fa-plus-circle","aria-hidden":"true"}),"  ","Add snippet"))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var S=a(16),N=a(5),A=a(12),P={recordings:{}};function j(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var I=Object(N.c)({recordings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.SET_RECORDING:var a=t.payload[0],n=t.payload[1],i=t.payload[2],o=P.recordings;return j(o[a])&&(o[a]={}),o[a][n]=i,Object(A.a)({},e,{recordings:o});case p.REMOVE_RECORDING:var r=t.payload[0],s=t.payload[1],c=P.recordings;return c[r][s]=null,Object(A.a)({},e,{recordings:c});default:return e}}}),L=function(){var e=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):N.d)(Object(N.a)(S.a));return Object(N.e)(I,e)}();window.store=L,r.a.render(i.a.createElement(s.a,{store:L},i.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){}},[[17,1,2]]]);
//# sourceMappingURL=main.78d29ba6.chunk.js.map